============================= test session starts =============================
platform win32 -- Python 3.12.3, pytest-9.0.2, pluggy-1.6.0 -- C:\Users\kaneko yu\Documents\jarvis-work\jarvis-ml-pipeline\.venv\Scripts\python.exe
cachedir: .pytest_cache
rootdir: C:\Users\kaneko yu\Documents\jarvis-work\jarvis-ml-pipeline
configfile: pytest.ini (WARNING: ignoring pytest config in pyproject.toml!)
plugins: anyio-4.12.0, asyncio-1.3.0, cov-7.0.0
asyncio: mode=Mode.STRICT, debug=False, asyncio_default_fixture_loop_scope=None, asyncio_default_test_loop_scope=function
collecting ... collected 5 items

tests/test_golden_path_e2e.py::test_run_task_golden_path_e2e PASSED      [ 20%]
tests/test_golden_path_e2e.py::test_run_task_error_handling PASSED       [ 40%]
tests/test_golden_path_e2e.py::test_run_task_retry_flow PASSED           [ 60%]
tests/test_golden_path_e2e.py::test_run_task_budget_error FAILED         [ 80%]
tests/test_golden_path_e2e.py::test_run_task_empty_llm_response PASSED   [100%]

================================== FAILURES ===================================
_________________________ test_run_task_budget_error __________________________
tests\test_golden_path_e2e.py:116: in test_run_task_budget_error
    assert any("Budget exhausted" in w for w in result.warnings)
E   assert False
E    +  where False = any(<generator object test_run_task_budget_error.<locals>.<genexpr> at 0x000001F29DF2CE10>)
---------------------------- Captured stdout call -----------------------------
DEBUG_EXEC: Attempt 1 for subtask 0413713d-f6c1-4dc8-9383-609bab486d17
DEBUG_LLM: last_user_msg='Test budget limit. keywords: trigger_budget_limit
Query: Test budget limit. keywords: trigger_budget_limit'
DEBUG_EXEC: Attempt 1 success. evaluation.ok=False
DEBUG_EXEC: Retry decision: should_retry=True, reason=validation_failed
DEBUG_EXEC: Attempt 2 for subtask 0413713d-f6c1-4dc8-9383-609bab486d17
DEBUG_LLM: last_user_msg='Test budget limit. keywords: trigger_budget_limit
Query: Test budget limit. keywords: trigger_budget_limit'
DEBUG_EXEC: Attempt 2 success. evaluation.ok=False
DEBUG_EXEC: Retry decision: should_retry=True, reason=validation_failed
DEBUG_EXEC: Attempt 3 for subtask 0413713d-f6c1-4dc8-9383-609bab486d17
DEBUG_LLM: last_user_msg='Test budget limit. keywords: trigger_budget_limit
Query: Test budget limit. keywords: trigger_budget_limit'
DEBUG_EXEC: Attempt 3 success. evaluation.ok=False
DEBUG_EXEC: Retry decision: should_retry=False, reason=max_attempts_reached
=========================== short test summary info ===========================
FAILED tests/test_golden_path_e2e.py::test_run_task_budget_error - assert False
 +  where False = any(<generator object test_run_task_budget_error.<locals>.<genexpr> at 0x000001F29DF2CE10>)
========================= 1 failed, 4 passed in 0.89s =========================
