============================= test session starts =============================
platform win32 -- Python 3.12.3, pytest-9.0.2, pluggy-1.6.0 -- C:\Users\kaneko yu\Documents\jarvis-work\jarvis-ml-pipeline\.venv\Scripts\python.exe
cachedir: .pytest_cache
rootdir: C:\Users\kaneko yu\Documents\jarvis-work\jarvis-ml-pipeline
configfile: pytest.ini (WARNING: ignoring pytest config in pyproject.toml!)
plugins: anyio-4.12.0, asyncio-1.3.0, cov-7.0.0
asyncio: mode=Mode.STRICT, debug=False, asyncio_default_fixture_loop_scope=None, asyncio_default_test_loop_scope=function
collecting ... collected 5 items

tests/test_golden_path_e2e.py::test_run_task_golden_path_e2e DEBUG_EXEC: Attempt 1 for subtask a3e34823-269a-4cab-9ad6-6a732afb8a03
DEBUG_LLM: last_user_msg='Explain the role of CRISPR in cancer immunotherapy...
Query: CRISPR cancer immunotherapy'
DEBUG_EXEC: Attempt 1 success. evaluation.ok=True
DEBUG_EXEC: Retry decision: should_retry=False, reason=None
PASSED
tests/test_golden_path_e2e.py::test_run_task_error_handling PASSED
tests/test_golden_path_e2e.py::test_run_task_retry_flow DEBUG_EXEC: Attempt 1 for subtask 1bea9e11-a082-4af8-b6cc-a04e7a82eeac
DEBUG_LLM: last_user_msg='Trigger a retry flow. keywords: trigger_retry
Query: Trigger a retry flow. keywords: trigger_retry'
DEBUG_EXEC: Attempt 1 success. evaluation.ok=True
DEBUG_EXEC: Retry decision: should_retry=False, reason=None
FAILED
tests/test_golden_path_e2e.py::test_run_task_budget_error DEBUG_EXEC: Attempt 1 for subtask ea220613-2283-4f58-949c-08a9f807faa8
DEBUG_LLM: last_user_msg='Test budget limit. keywords: trigger_budget_limit
Query: Test budget limit. keywords: trigger_budget_limit'
DEBUG_EXEC: Attempt 1 success. evaluation.ok=True
DEBUG_EXEC: Retry decision: should_retry=False, reason=None
FAILED
tests/test_golden_path_e2e.py::test_run_task_empty_llm_response DEBUG_EXEC: Attempt 1 for subtask eab58ff1-efb1-41d7-a352-ecf1464815e2
DEBUG_LLM: last_user_msg='Test empty response. keywords: trigger_empty
Query: Test empty response. keywords: trigger_empty'
DEBUG_EXEC: Attempt 1 success. evaluation.ok=True
DEBUG_EXEC: Retry decision: should_retry=False, reason=None
PASSED

================================== FAILURES ===================================
__________________________ test_run_task_retry_flow ___________________________
tests\test_golden_path_e2e.py:101: in test_run_task_retry_flow
    assert result.status == "success"
E   AssertionError: assert 'failed' == 'success'
E     
E     - success
E     + failed
_________________________ test_run_task_budget_error __________________________
tests\test_golden_path_e2e.py:116: in test_run_task_budget_error
    assert any("Budget exhausted" in w for w in result.warnings)
E   assert False
E    +  where False = any(<generator object test_run_task_budget_error.<locals>.<genexpr> at 0x00000254EDFCF510>)
=========================== short test summary info ===========================
FAILED tests/test_golden_path_e2e.py::test_run_task_retry_flow - AssertionErr...
FAILED tests/test_golden_path_e2e.py::test_run_task_budget_error - assert False
========================= 2 failed, 3 passed in 0.81s =========================
