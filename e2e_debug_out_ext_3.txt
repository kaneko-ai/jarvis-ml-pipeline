============================= test session starts =============================
platform win32 -- Python 3.12.3, pytest-9.0.2, pluggy-1.6.0 -- C:\Users\kaneko yu\Documents\jarvis-work\jarvis-ml-pipeline\.venv\Scripts\python.exe
cachedir: .pytest_cache
rootdir: C:\Users\kaneko yu\Documents\jarvis-work\jarvis-ml-pipeline
configfile: pytest.ini (WARNING: ignoring pytest config in pyproject.toml!)
plugins: anyio-4.12.0, asyncio-1.3.0, cov-7.0.0
asyncio: mode=Mode.STRICT, debug=False, asyncio_default_fixture_loop_scope=None, asyncio_default_test_loop_scope=function
collecting ... collected 5 items

tests/test_golden_path_e2e.py::test_run_task_golden_path_e2e DEBUG_EXEC: Attempt 1 for subtask 7471b332-2bf5-4732-92b2-3476018f9328
DEBUG_LLM: last_user_msg='Explain the role of CRISPR in cancer immunotherapy...
Query: CRISPR cancer immunotherapy'
DEBUG_EXEC: Attempt 1 success. evaluation.ok=True
DEBUG_EXEC: Retry decision: should_retry=False, reason=None
DEBUG_APP: Final warnings: ["QA gate failed: cannot import name 'run_qa_gate' from 'jarvis_core.style' (C:\\Users\\kaneko yu\\Documents\\jarvis-work\\jarvis-ml-pipeline\\jarvis_core\\style\\__init__.py)"]
PASSED
tests/test_golden_path_e2e.py::test_run_task_error_handling DEBUG_APP: Final warnings: ['Execution error: Task goal cannot be empty', {'code': 'EXECUTION_ERROR', 'message': 'Task goal cannot be empty', 'severity': 'error'}, "QA gate failed: cannot import name 'run_qa_gate' from 'jarvis_core.style' (C:\\Users\\kaneko yu\\Documents\\jarvis-work\\jarvis-ml-pipeline\\jarvis_core\\style\\__init__.py)"]
PASSED
tests/test_golden_path_e2e.py::test_run_task_retry_flow DEBUG_EXEC: Attempt 1 for subtask fab078b9-7211-4acc-992d-73e8c1421787
DEBUG_LLM: last_user_msg='Trigger a retry flow. keywords: trigger_retry
Query: Trigger a retry flow. keywords: trigger_retry'
DEBUG_EXEC: Attempt 1 success. evaluation.ok=False
DEBUG_EXEC: Retry decision: should_retry=True, reason=validation_failed
DEBUG_EXEC: Attempt 2 for subtask fab078b9-7211-4acc-992d-73e8c1421787
DEBUG_LLM: last_user_msg='Trigger a retry flow. keywords: trigger_retry
Query: Trigger a retry flow. keywords: trigger_retry'
DEBUG_EXEC: Attempt 2 success. evaluation.ok=True
DEBUG_EXEC: Retry decision: should_retry=False, reason=None
DEBUG_APP: Final warnings: ["QA gate failed: cannot import name 'run_qa_gate' from 'jarvis_core.style' (C:\\Users\\kaneko yu\\Documents\\jarvis-work\\jarvis-ml-pipeline\\jarvis_core\\style\\__init__.py)"]
PASSED
tests/test_golden_path_e2e.py::test_run_task_budget_error DEBUG_EXEC: Attempt 1 for subtask c7538643-1696-4218-93dc-0dcd8b536fb4
DEBUG_LLM: last_user_msg='Test budget limit. keywords: trigger_budget_limit
Query: Test budget limit. keywords: trigger_budget_limit'
DEBUG_EXEC: Attempt 1 success. evaluation.ok=False
DEBUG_EXEC: Retry decision: should_retry=True, reason=validation_failed
DEBUG_EXEC: Attempt 2 for subtask c7538643-1696-4218-93dc-0dcd8b536fb4
DEBUG_LLM: last_user_msg='Test budget limit. keywords: trigger_budget_limit
Query: Test budget limit. keywords: trigger_budget_limit'
DEBUG_EXEC: Attempt 2 success. evaluation.ok=False
DEBUG_EXEC: Retry decision: should_retry=True, reason=validation_failed
DEBUG_EXEC: Attempt 3 for subtask c7538643-1696-4218-93dc-0dcd8b536fb4
DEBUG_LLM: last_user_msg='Test budget limit. keywords: trigger_budget_limit
Query: Test budget limit. keywords: trigger_budget_limit'
DEBUG_EXEC: Attempt 3 success. evaluation.ok=False
DEBUG_EXEC: Retry decision: should_retry=False, reason=max_attempts_reached
DEBUG_APP: Final warnings: ["Execution error: llm_error: No module named 'google.genai'", {'code': 'EXECUTION_ERROR', 'message': "llm_error: No module named 'google.genai'", 'severity': 'error'}, "QA gate failed: cannot import name 'run_qa_gate' from 'jarvis_core.style' (C:\\Users\\kaneko yu\\Documents\\jarvis-work\\jarvis-ml-pipeline\\jarvis_core\\style\\__init__.py)"]
FAILED
tests/test_golden_path_e2e.py::test_run_task_empty_llm_response DEBUG_EXEC: Attempt 1 for subtask 043f93f9-ae25-4b51-9979-1b370a510fd0
DEBUG_LLM: last_user_msg='Test empty response. keywords: trigger_empty
Query: Test empty response. keywords: trigger_empty'
DEBUG_EXEC: Attempt 1 success. evaluation.ok=False
DEBUG_EXEC: Retry decision: should_retry=True, reason=validation_failed
DEBUG_EXEC: Attempt 2 for subtask 043f93f9-ae25-4b51-9979-1b370a510fd0
DEBUG_LLM: last_user_msg='Test empty response. keywords: trigger_empty
Query: Test empty response. keywords: trigger_empty'
DEBUG_EXEC: Attempt 2 success. evaluation.ok=False
DEBUG_EXEC: Retry decision: should_retry=True, reason=validation_failed
DEBUG_EXEC: Attempt 3 for subtask 043f93f9-ae25-4b51-9979-1b370a510fd0
DEBUG_LLM: last_user_msg='Test empty response. keywords: trigger_empty
Query: Test empty response. keywords: trigger_empty'
DEBUG_EXEC: Attempt 3 success. evaluation.ok=False
DEBUG_EXEC: Retry decision: should_retry=False, reason=max_attempts_reached
DEBUG_APP: Final warnings: ['Execution error: empty_answer', {'code': 'EXECUTION_ERROR', 'message': 'empty_answer', 'severity': 'error'}, "QA gate failed: cannot import name 'run_qa_gate' from 'jarvis_core.style' (C:\\Users\\kaneko yu\\Documents\\jarvis-work\\jarvis-ml-pipeline\\jarvis_core\\style\\__init__.py)"]
PASSED

================================== FAILURES ===================================
_________________________ test_run_task_budget_error __________________________
tests\test_golden_path_e2e.py:116: in test_run_task_budget_error
    assert any("Budget exhausted" in w for w in result.warnings)
E   assert False
E    +  where False = any(<generator object test_run_task_budget_error.<locals>.<genexpr> at 0x000001FA79886810>)
=========================== short test summary info ===========================
FAILED tests/test_golden_path_e2e.py::test_run_task_budget_error - assert False
========================= 1 failed, 4 passed in 0.84s =========================
